!function(a,b,c,d){var e,f=a.mobiscroll,g=f.classes,h=f.instances,i=f.util,j=i.jsPrefix,k=i.has3d,l=i.hasFlex,m=i.getCoord,n=i.constrain,o=i.testTouch;g.Scroller=function(b,f,p){function q(b){!o(b,this)||e||S||N||z(this)||(b.preventDefault(),b.stopPropagation(),e=!0,O="clickpick"!=Q.mode,$=a(".dw-ul",this),B($),T=eb[_]!==d,X=T?D($):fb[_],U=m(b,"Y"),V=new Date,W=U,F($,_,X,.001),O&&$.closest(".dwwl").addClass("dwa"),"mousedown"===b.type&&a(c).on("mousemove",r).on("mouseup",s))}function r(a){e&&O&&(a.preventDefault(),a.stopPropagation(),W=m(a,"Y"),(Math.abs(W-U)>3||T)&&(F($,_,n(X+(U-W)/P,Y-1,Z+1)),T=!0))}function s(b){if(e){var d,f,g,h=new Date-V,i=n(X+(U-W)/P,Y-1,Z+1),j=$.offset().top;if(b.stopPropagation(),k&&300>h?(d=(W-U)/h,f=d*d/Q.speedUnit,0>W-U&&(f=-f)):f=W-U,g=Math.round(X-f/P),!T){var l=Math.floor((W-j)/P),m=a(a(".dw-li",$)[l]),o=m.hasClass("dw-v"),p=O;R("onValueTap",[m])!==!1&&o?g=l:p=!0,p&&o&&(m.addClass("dw-hl"),setTimeout(function(){m.removeClass("dw-hl")},100))}O&&I($,g,0,!0,Math.round(i)),"mouseup"===b.type&&a(c).off("mousemove",r).off("mouseup",s),e=!1}}function t(b){N=a(this),o(b,this)&&y(b,N.closest(".dwwl"),N.hasClass("dwwbp")?J:K),"mousedown"===b.type&&a(c).on("mouseup",u)}function u(b){N=null,S&&(clearInterval(bb),S=!1),"mouseup"===b.type&&a(c).off("mouseup",u)}function v(b){38==b.keyCode?y(b,a(this),K):40==b.keyCode&&y(b,a(this),J)}function w(){S&&(clearInterval(bb),S=!1)}function x(b){if(!z(this)){b.preventDefault(),b=b.originalEvent||b;var c=b.wheelDelta?b.wheelDelta/120:b.detail?-b.detail/3:0,d=a(".dw-ul",this);B(d),I(d,Math.round(fb[_]-c),0>c?1:2)}}function y(a,b,c){if(a.stopPropagation(),a.preventDefault(),!S&&!z(b)&&!b.hasClass("dwa")){S=!0;var d=b.find(".dw-ul");B(d),clearInterval(bb),bb=setInterval(function(){c(d)},Q.delay),c(d)}}function z(b){if(a.isArray(Q.readonly)){var c=a(".dwwl",M).index(b);return Q.readonly[c]}return Q.readonly}function A(b){var c='<div class="dw-bf">',d=hb[b],e=1,f=d.labels||[],g=d.values,h=d.keys||g;return a.each(g,function(a,b){e%20===0&&(c+='</div><div class="dw-bf">'),c+='<div role="option" aria-selected="false" class="dw-li dw-v" data-val="'+h[a]+'"'+(f[a]?' aria-label="'+f[a]+'"':"")+' style="height:'+P+"px;line-height:"+P+'px;"><div class="dw-i"'+(ab>1?' style="line-height:'+Math.round(P/ab)+"px;font-size:"+Math.round(P/ab*.8)+'px;"':"")+">"+b+"</div></div>",e++}),c+="</div>"}function B(b){var c=b.closest(".dwwl").hasClass("dwwms");Y=a(".dw-li",b).index(a(c?".dw-li":".dw-v",b).eq(0)),Z=Math.max(Y,a(".dw-li",b).index(a(c?".dw-li":".dw-v",b).eq(-1))-(c?Q.rows-1:0)),_=a(".dw-ul",M).index(b)}function C(a){var c=Q.headerText;return c?"function"==typeof c?c.call(b,a):c.replace(/\{value\}/i,a):""}function D(a){return Math.round(-i.getPosition(a,!0)/P)}function E(a,b){clearTimeout(eb[b]),delete eb[b],a.closest(".dwwl").removeClass("dwa")}function F(a,b,c,d,e){var f=-c*P,g=a[0].style;f==gb[b]&&eb[b]||(gb[b]=f,k?(g[j+"Transition"]=i.prefix+"transform "+(d?d.toFixed(3):0)+"s ease-out",g[j+"Transform"]="translate3d(0,"+f+"px,0)"):g.top=f+"px",eb[b]&&E(a,b),d&&e&&(a.closest(".dwwl").addClass("dwa"),eb[b]=setTimeout(function(){E(a,b)},1e3*d)),fb[b]=c)}function G(b,c,d,e){var f=a('.dw-li[data-val="'+b+'"]',c),g=a(".dw-li",c),h=g.index(f),i=g.length;if(e)B(c);else if(!f.hasClass("dw-v")){for(var j=f,k=f,l=0,m=0;h-l>=0&&!j.hasClass("dw-v");)l++,j=g.eq(h-l);for(;i>h+m&&!k.hasClass("dw-v");)m++,k=g.eq(h+m);(l>m&&m&&2!==d||!l||0>h-l||1==d)&&k.hasClass("dw-v")?(f=k,h+=m):(f=j,h-=l)}return{cell:f,v:e?n(h,Y,Z):h,val:f.hasClass("dw-v")?f.attr("data-val"):null}}function H(b,c,e,f,g){R("validate",[M,c,b,f])!==!1&&(a(".dw-ul",M).each(function(e){var h=a(this),i=h.closest(".dwwl").hasClass("dwwms"),j=e==c||c===d,k=G(cb._tempWheelArray[e],h,f,i),l=k.cell;(!l.hasClass("dw-sel")||j)&&(cb._tempWheelArray[e]=k.val,i||(a(".dw-sel",h).removeAttr("aria-selected"),l.attr("aria-selected","true")),a(".dw-sel",h).removeClass("dw-sel"),l.addClass("dw-sel"),F(h,e,k.v,j?b:.1,j?g:!1))}),R("onValidated",[]),cb._tempValue=Q.formatResult(cb._tempWheelArray),cb.live&&(cb._hasValue=e||cb._hasValue,L(e,e,0,!0)),cb._header.html(C(cb._tempValue)),e&&R("onChange",[cb._tempValue]))}function I(b,c,e,f,g){c=n(c,Y,Z);var h=a(".dw-li",b).eq(c),i=g===d?c:g,j=g!==d,k=_,l=Math.abs(c-i),m=f?c==i?.1:l*Q.timeUnit*Math.max(.5,(100-l)/100):0;cb._tempWheelArray[k]=h.attr("data-val"),F(b,k,c,m,j),setTimeout(function(){H(m,k,!0,e,j)},10)}function J(a){var b=fb[_]+1;I(a,b>Z?Y:b,1,!0)}function K(a){var b=fb[_]-1;I(a,Y>b?Z:b,2,!0)}function L(a,b,c,d,e){cb._isVisible&&!d&&H(c),cb._tempValue=Q.formatResult(cb._tempWheelArray),e||(cb._wheelArray=cb._tempWheelArray.slice(0),cb._value=cb._hasValue?cb._tempValue:null),a&&(R("onValueFill",[cb._hasValue?cb._tempValue:"",b]),cb._isInput&&db.val(cb._hasValue?cb._tempValue:""),b&&(cb._preventChange=!0,db.change()))}var M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,ab,bb,cb=this,db=a(b),eb={},fb={},gb={},hb=[];g.Widget.call(this,b,f,!0),cb.setVal=cb._setVal=function(c,e,f,g,h){cb._hasValue=null!==c&&c!==d,cb._tempWheelArray=a.isArray(c)?c.slice(0):Q.parseValue.call(b,c,cb)||[],L(e,f===d?e:f,h,!1,g)},cb.getVal=cb._getVal=function(a){var b=cb._hasValue?cb[a?"_tempValue":"_value"]:null;return i.isNumeric(b)?+b:b},cb.setArrayVal=cb.setVal,cb.getArrayVal=function(a){return a?cb._tempWheelArray:cb._wheelArray},cb.setValue=function(a,b,c,d,e){cb.setVal(a,b,e,d,c)},cb.getValue=cb.getArrayVal,cb.changeWheel=function(b,c,e){if(M){var f=0,g=b.length;a.each(Q.wheels,function(h,i){return a.each(i,function(h,i){return a.inArray(f,b)>-1&&(hb[f]=i,a(".dw-ul",M).eq(f).html(A(f)),g--,!g)?(cb.position(),H(c,d,e),!1):void f++}),g?void 0:!1})}},cb.getValidCell=G,cb._generateContent=function(){var b,c="",e=0;return a.each(Q.wheels,function(f,g){c+='<div class="mbsc-w-p dwc'+("scroller"!=Q.mode?" dwpm":" dwsc")+(Q.showLabel?"":" dwhl")+'"><div class="dwwc"'+(Q.maxWidth?"":' style="max-width:600px;"')+">"+(l?"":'<table class="dw-tbl" cellpadding="0" cellspacing="0"><tr>'),a.each(g,function(a,f){hb[e]=f,b=f.label!==d?f.label:a,c+="<"+(l?"div":"td")+' class="dwfl" style="'+(Q.fixedWidth?"width:"+(Q.fixedWidth[e]||Q.fixedWidth)+"px;":(Q.minWidth?"min-width:"+(Q.minWidth[e]||Q.minWidth)+"px;":"min-width:"+Q.width+"px;")+(Q.maxWidth?"max-width:"+(Q.maxWidth[e]||Q.maxWidth)+"px;":""))+'"><div class="dwwl dwwl'+e+(f.multiple?" dwwms":"")+'">'+("scroller"!=Q.mode?'<div class="dwb-e dwwb dwwbp '+(Q.btnPlusClass||"")+'" style="height:'+P+"px;line-height:"+P+'px;"><span>+</span></div><div class="dwb-e dwwb dwwbm '+(Q.btnMinusClass||"")+'" style="height:'+P+"px;line-height:"+P+'px;"><span>&ndash;</span></div>':"")+'<div class="dwl">'+b+'</div><div tabindex="0" aria-live="off" aria-label="'+b+'" role="listbox" class="dwww"><div class="dww" style="height:'+Q.rows*P+'px;"><div class="dw-ul" style="margin-top:'+(f.multiple?0:Q.rows/2*P-P/2)+'px;">',c+=A(e)+'</div></div><div class="dwwo"></div></div><div class="dwwol"'+(Q.selectedLineHeight?' style="height:'+P+"px;margin-top:-"+(P/2+(Q.selectedLineBorder||0))+'px;"':"")+"></div></div>"+(l?"</div>":"</td>"),e++}),c+=(l?"":"</tr></table>")+"</div></div>"}),c},cb._attachEvents=function(a){a.on("DOMMouseScroll mousewheel",".dwwl",x).on("keydown",".dwwl",v).on("keyup",".dwwl",w).on("touchstart mousedown",".dwwl",q).on("touchmove",".dwwl",r).on("touchend",".dwwl",s).on("touchstart mousedown",".dwwb",t).on("touchend",".dwwb",u)},cb._markupReady=function(){M=cb._markup,H()},cb._fillValue=function(){cb._hasValue=!0,L(!0,!0,0,!0)},cb._readValue=function(){var a=db.val()||"";cb._hasValue=""!==a,cb._tempWheelArray=cb._wheelArray?cb._wheelArray.slice(0):Q.parseValue(a,cb)||[],L()},cb._processSettings=function(){Q=cb.settings,R=cb.trigger,P=Q.height,ab=Q.multiline,cb._isLiquid="liquid"===(Q.layout||(/top|bottom/.test(Q.display)&&1==Q.wheels.length?"liquid":"")),ab>1&&(Q.cssClass=(Q.cssClass||"")+" dw-ml")},cb._selectedValues={},p||(h[b.id]=cb,cb.init(f))},g.Scroller.prototype._class="scroller",g.Scroller.prototype._defaults=a.extend({},g.Widget.prototype._defaults,{minWidth:80,height:40,rows:3,multiline:1,delay:300,readonly:!1,showLabel:!0,wheels:[],mode:"scroller",preset:"",speedUnit:.0012,timeUnit:.08,formatResult:function(a){return a.join(" ")},parseValue:function(b,c){var e,f=[],g=[],h=0;return null!==b&&b!==d&&(f=(b+"").split(" ")),a.each(c.settings.wheels,function(b,c){a.each(c,function(b,c){e=c.keys||c.values,g.push(-1!==a.inArray(f[h],e)?f[h]:e[0]),h++})}),g}})}(jQuery,window,document);