(function(){var a,b,c,d,e,f,g,h,i,j,k,l=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};k=function(a,b){var c,d,e,f,g,h,i;if(null==a)return ko.observable(b);switch(a.type){case"string":case"number":case"integer":case"boolean":return ko.observable(b);case"object":if(null==b)return ko.observable(b);if(null!=a.properties){i=a.properties;for(e in i)f=i[e],b[e]=k(f,b[e])}return ko.observable(b);case"array":if(null==b)return ko.observableArray(b);for(d=g=0,h=b.length;h>g;d=++g)c=b[d],b[d]=k(a.items,b[d]);return ko.observableArray(b);default:return ko.observable(b)}},j=function(a){var b,c,d,e,f,g,h,i;if(a=ko.unwrap(a),null==a)return a;switch(g=a,f=Array.isArray(a)?"array":typeof a){case"object":g={};for(d in a)e=a[d],g[d]=j(e);break;case"array":for(g=[],c=h=0,i=a.length;i>h;c=++h)b=a[c],g[c]=j(b)}return g},e=function(){return function(a){var b;if(null!=a.defaut)return a["default"];if((null!=(b=a["enum"])?b.length:void 0)>0)return a["enum"][0];switch(a.type){case"string":return"";case"number":case"integer":return 0;case"boolean":return!1;case"object":return{};case"array":return[]}}}(this),h=function(a){var b,c,d,f,g,h,i;if(null==a.schema.properties)return[];d=ko.unwrap(a.value),null==d&&(d={},a.value(d)),h=[],i=a.schema.properties;for(c in i)f=i[c],null!=f.definedBy&&(b=ko.unwrap(d[f.definedBy]),null!=b&&b in f.options&&(f=f.options[b])),g=j(d[c]),null==g&&null!=a.schema.required&&l.call(a.schema.required,c)>=0&&(g=e(f)),d[c]=k(f,g),h.push({schema:f,value:d[c]});return h},g=function(a){var b;return null==ko.unwrap(a)?[]:function(){var c,d,e,f;for(e=ko.unwrap(a),f=[],c=0,d=e.length;d>c;c++)b=e[c],f.push({schema:this.items||{},value:b});return f}.call(this)},i=function(a,b){return b.schema.editingItem({schema:b.schema,value:k(b.schema,j(b.value)),index:a})},c=function(a,b){var c,d;return d=b.schema.editingItem(),null!=d.index?(c=a.value(),c[d.index](d.value()),a.value(c)):a.value.push(d.value),b.schema.editingItem(null)},b=function(a){return a.schema.editingItem(null)},a=function(a){var b;b=null!=a.schema.items["default"]?k(a.schema.items,JSON.parse(JSON.stringify(a.schema.items["default"]))):k(a.schema.items,e(a.schema.items)),a.schema.items.editingItem({schema:a.schema.items,value:b})},f=function(a){var b,c;return c=j(a),"object"===this.type&&null!=this.properties&&(b="",null!=this.properties.name&&(b=c.name),null!=this.properties.id&&(b.length>0?b+=" ("+c.id+")":b=c.id),null!=b&&b.length>0)?b:JSON.stringify(c)},d=function(j,k){var m,n,o,p,q,r,s,t;switch(j.name=k,j.notDefault=function(){return function(a){return ko.pureComputed({read:function(){return null!=("function"==typeof a.value?a.value():void 0)},write:function(b){var c;return b?(c=a.schema["default"],null==c&&(c=e(a.schema)),a.value(c)):a.value(void 0)}})}}(this),j.enabled=function(){return function(a){return null!=("function"==typeof a.value?a.value():void 0)}}(this),j.valueOrDefault=function(){return function(a){return ko.pureComputed({read:function(){return null!=("function"==typeof a.value?a.value():void 0)?a.value():a.schema["default"]},write:function(b){var c;return("number"===(c=a.schema.type)||"integer"===c)&&(b=parseFloat(b)),a.value(b)}})}}(this),j.type){case"object":if(j.getProperties=h,null!=j.properties){q=j.properties;for(k in q)if(p=q[k],null!=j.required&&(p.notRequired=!(l.call(j.required,k)>=0)),d(p,k),null!=(null!=(r=p.defines)?r.property:void 0)){m=j.properties[p.defines.property],m.options=p.defines.options,m.definedBy=k,s=m.options;for(n in s)o=s[n],d(o,p.defines.property)}}break;case"array":j.getItems=g,null==j.items&&(j.items={}),j.items.getItemLabel=f,j.items.onEditItemClick=i,j.items.editOk=c,j.items.editCancel=b,j.items.addItem=a,j.items.editingItem=ko.observable(null),j.items.isSorting=ko.observable(!1),j.items.onSorted=function(){return function(a){return function(b,c,d){var e,f,g,h,i,j;for(g=0,h=0,e=a.value(),b=b.value(),c=null!=c?c.value():null,d=null!=d?d.value():null,f=i=0,j=e.length;j>=0?j>i:i>j;f=j>=0?++i:--i)e[f]()===b&&(g=f),e[f]()===d&&(h=f-1);return null==c&&(h=0),null==d&&(h=e.length-1),g!==h?(e.splice(g,1),e.splice(h,0,ko.observable(b)),a.value(e)):void 0}}}(this),j.items.onRemove=function(){return function(a){return function(b){var c,d,e,f;for(c=a.value(),b=b.value(),d=e=0,f=c.length;f>=0?f>e:e>f;d=f>=0?++e:--e)if(c[d]()===b)return c.splice(d,1),void a.value(c)}}}(this),d(j.items,null);break;case"string":case"number":case"integer":case"boolean":null!=(null!=(t=j.defines)?t.options:void 0)&&null==j["enum"]&&(j["enum"]=Object.keys(j.defines.options))}},window.jsonschemaeditor={wrap:k,unwrap:j,enhanceSchema:d}}).call(this);