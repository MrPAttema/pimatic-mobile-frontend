(function(){var a;a=pimatic.tryCatch,$(document).ready(a(function(a){var b,c;return b=function(){function a(){}return a.prototype.showLoginDialog=function(){var a;return this.redirectPage=(null!=(a=$.mobile.activePage)?a.attr("id"):void 0)||"index","login-page"===this.redirectPage&&(this.redirectPage="index"),pimatic.socket.io.disconnect(),jQuery.mobile.changePage("#login-page",{transition:"flip"}),$("#login-page").bind("pageshow",function(){return $("#loginForm  #firstName").focus()})},a.prototype.hideLoginDialog=function(){var a,b;return a=(null!=(b=$.mobile.activePage)?b.attr("id"):void 0)||"index","login-page"===a?jQuery.mobile.changePage("#"+(this.redirectPage||"index"),{transition:"flip"}):void 0},a}(),pimatic.pages.login=c=new b})),$(document).on("pagebeforeshow","#login-page",function(a){var b;return 0!==(null!=(b=pimatic.socket.io)?b.connected.length:void 0)?(pimatic.pages.login.hideLoginDialog(),!1):!0}),$(document).on("submit","#login-page #loginForm",a(function(a){var b;return b=$("#loginForm #rememberMe").val(),pimatic.loading("socket","show",{text:__("Logging in"),blocking:!0}),$.ajax({type:"POST",url:"/login",data:$("#loginForm").serialize(),global:!1}).done(function(a){return pimatic.loading("socket","show",{text:__("Connecting"),blocking:!0}),setTimeout(function(){return pimatic.rememberme(a.rememberMe),pimatic.socket.io.reconnection(!0),pimatic.socket.io.connect()},1)}).fail(function(a){return function(){return pimatic.loading("socket","hide")}}(this)).fail(ajaxAlertFail),a.preventDefault(),!1}))}).call(this);