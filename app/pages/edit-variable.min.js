(function(){$(document).on("pagebeforecreate","#edit-variable-page",function(a){var b,c;if(null==pimatic.pages.editVariable){b=function(){function a(){this.pageTitle=ko.computed(function(a){return function(){return"add"===a.action()?__("Add new variable"):__("Edit variable")}}(this)),this.valueLabelText=ko.computed(function(a){return function(){return"value"===a.variableType()?__("Value"):__("Expr.")}}(this))}return a.prototype.autocompleteAjax=null,a.prototype.autocompleEnabled=!1,a.prototype.action=ko.observable("add"),a.prototype.variableName=ko.observable(""),a.prototype.variableValue=ko.observable(""),a.prototype.variableType=ko.observable("value"),a.prototype.variableUnit=ko.observable(""),a.prototype.resetFields=function(){return this.variableName(""),this.variableValue(""),this.variableType("value"),this.variableUnit("")},a.prototype.onSubmit=function(){var a;return pimatic.isValidVariableName(this.variableName())?(a={name:this.variableName(),type:this.variableType(),valueOrExpression:this.variableValue(),unit:this.variableUnit()},function(){switch(this.action()){case"add":return pimatic.client.rest.addVariable(a);case"update":return pimatic.client.rest.updateVariable(a);default:throw new Error("Illegal variable action: "+action())}}.call(this).done(function(a){return a.success?$.mobile.changePage("#variables-page",{transition:"slide",reverse:!0}):alert(a.error)}).fail(ajaxAlertFail),!1):void alert(__(pimatic.invalidVariableNameMessage))},a.prototype.onRemove=function(){var a;return a=confirm(__("Do you really want to delete the %s variable?",this.variableName())),a&&pimatic.client.rest.removeVariable({name:this.variableName()}).done(function(a){return a.success?$.mobile.changePage("#variables-page",{transition:"slide",reverse:!0}):alert(a.error)}).fail(ajaxAlertFail),!1},a}();try{pimatic.pages.editVariable=new b}catch(d){c=d,TraceKit.report(c)}}}),$(document).on("pagecreate","#edit-variable-page",function(a){var b;try{return ko.applyBindings(pimatic.pages.editVariable,$("#edit-variable-page")[0])}catch(c){return b=c,TraceKit.report(b)}}),$(document).on("pagebeforeshow","#edit-variable-page",function(a){var b,c,d;b=pimatic.pages.editVariable,c=jQuery.mobile.pageParams,jQuery.mobile.pageParams={},"update"===(null!=c?c.action:void 0)?(d=c.variable,b.action("update"),b.variableName(d.name),b.variableValue("value"===d.type()?d.value():d.exprInputStr()),b.variableType(d.type()),b.variableUnit(d.unit())):(b.resetFields(),b.action("add"))})}).call(this);