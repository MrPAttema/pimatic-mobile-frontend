(function(){var a;a=Array.prototype.concat,LazyLoad.js(a.apply(scripts.jsonschemaeditor)),$(document).on("pagebeforecreate","#edit-plugin-page",function(a){var b,c;if(null==pimatic.pages.editPlugin){b=function(){function a(){this.pageTitle=ko.computed(function(a){return function(){return __("Plugin Config")}}(this)),this.pluginName.subscribe(function(a){return function(b){return null!=b&&"string"==typeof b&&b.length>0?pimatic.client.rest.getPluginConfigSchema({pluginName:"pimatic-"+b}).done(function(c){var d,e,f;return null!=c.success?(e=c.configSchema,delete e.properties.active,delete e.properties.plugin,f=jsonschemaeditor.unwrap(a.pluginConfig()),d=jsonschemaeditor.wrap(e,f),a.configSchema(null),a.pluginConfig(d()),jsonschemaeditor.enhanceSchema(e,null),e.name=b,a.configSchema(e)):void 0}):a.configSchema(null)}}(this))}return a.prototype.action=ko.observable("add"),a.prototype.pluginName=ko.observable(""),a.prototype.pluginConfig=ko.observable({}),a.prototype.configSchema=ko.observable(null),a.prototype.afterRenderItem=function(a,b){var c;return c=$("#sortable-handle-template").text(),$(a).find("a").before($(c))},a.prototype.resetFields=function(){return this.pluginName(""),this.pluginConfig({}),this.configSchema(null)},a.prototype.onSubmit=function(){var a,b,c;return c=this.pluginName(),b=jsonschemaeditor.unwrap(this.pluginConfig()),a=[],jsonschemaeditor.validate(this.configSchema(),b,a),a.length>0?void alert(a.join("\n")):(b.plugin=c,b.active=!0,pimatic.client.rest.updatePluginConfig({pluginName:c,config:b}).done(function(a){var b;return b=pimatic.pages.plugins,b.refresh(),b.restartRequired(!0),a.success?$.mobile.changePage("#plugins-page",{transition:"slide",reverse:!0}):alert(a.error)}).fail(ajaxAlertFail),!1)},a}();try{pimatic.pages.editPlugin=new b}catch(d){c=d,TraceKit.report(c)}}}),$(document).on("pagebeforeshow","#edit-plugin-page",function(a){}),$(document).on("pagecreate","#edit-plugin-page",function(a){var b;try{return ko.applyBindings(pimatic.pages.editPlugin,$("#edit-plugin-page")[0])}catch(c){return b=c,TraceKit.report(b)}}),$(document).on("pagebeforeshow","#edit-plugin-page",function(a){var b,c;return b=pimatic.pages.editPlugin,c=jQuery.mobile.pageParams,jQuery.mobile.pageParams={},null!=c?(b.pluginName(null),b.configSchema(null),pimatic.client.rest.getPluginConfig({pluginName:c.pluginName}).always(function(a){return function(a){var d;return null!=a.success?(d=a.config||{},b.pluginConfig(d),b.pluginName(c.pluginName)):void 0}}(this))):void 0})}).call(this);